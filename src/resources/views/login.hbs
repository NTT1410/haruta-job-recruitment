<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>{{> title}}</title>
	<!-- Font Awesome -->
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
	<!-- Google Fonts -->
	<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet" />

	<!-- MDB -->
	<link rel="stylesheet" href="/MDBootstrap 5 v2.0.0/css/mdb.min.css" />

	<!-- MDB -->
	<link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.4.2/mdb.min.css" rel="stylesheet" />
	<link rel="stylesheet" href="/css/app.css">
</head>

<body>
	<div class="app">
		<div id="intro" class="bg-image shadow-2-strong">
			<div class="mask d-flex align-items-center h-100" style="background-color: rgba(0, 0, 0, 0.5);">
				<div class="container">
					<div class="row justify-content-center">
						<div class="col-xl-5 col-md-8">
							<form class="bg-white rounded-5 shadow-5-strong p-5">
								<!-- logo brand -->
								<div class="mb-4">
									<img src="/img/logo.png" alt="HaRuTa">
								</div>

								<!-- Email input -->
								<div class="form-outline mb-4">
									<input type="username" id="username" name="username" class="form-control"
										required />
									<label class="form-label" for="username">Username</label>
								</div>
									<div class="username error"></div>

								<!-- Password input -->
								<div class="form-outline mb-4">
									<input type="password" id="password" name="password" class="form-control"
										required />
									<label class="form-label" for="password">Password</label>
								</div>
									<div class="password error"></div>

								<!-- 2 column grid layout for inline styling -->
								<div class="row mb-4">


									<div class="col text-center">
										<!-- Simple link -->
										<a href="#!">Forgot password?</a>
									</div>
								</div>

								<!-- Submit button -->
								<button type="submit" class="btn btn-primary btn-rounded btn-block">Sign in</button>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script>
		const form = document.querySelector("form");
		const usernamError = document.querySelector('.username.error')
        const passwordError = document.querySelector('.password.error')

		form.addEventListener("submit", async (e) => {
			 e.preventDefault();

            // reset errors
            usernamError.textContent = "";
            passwordError.textContent = "";

            // get value
            const username = form.username.value;
            const password = form.password.value;


            try {
                const res = await fetch('/login', {
                    method: 'POST',
                    body: JSON.stringify({ username, password}),
                    headers: { 'Content-Type': 'application/json' },
                });
                const data = await res.json();
                console.log(data);
                if(data.errors){
                    usernamError.textContent = data.errors.username;
                    passwordError.textContent = data.errors.password;
                }
                if (data.user){
                    location.assign("/");
                }

            }
            catch (err) {
                console.log(err);
            }
		});
	</script>
	<!-- MDB -->
	<script type="text/javascript" src="/MDBootstrap 5 v2.0.0/js/mdb.min.js"></script>
	<!-- MDB -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
		integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
		crossorigin="anonymous" referrerpolicy="no-referrer"></scrip >
				<script type="text/javascript" src="/js/app.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.4.2/mdb.min.js"></script>
</body>

</html>